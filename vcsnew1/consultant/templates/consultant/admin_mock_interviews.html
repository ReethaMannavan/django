
{% extends "base.html" %}
{% block title %}Admin Mock Interviews{% endblock %}

{% block content %}
<div class="container py-4">

  <div class="d-flex justify-content-between align-items-center mb-3">
    <h2 class="fw-bold m-0">Mock Interviews (Pro Plus)</h2>
    <span class="badge bg-success">Admin Panel</span>
  </div>

  <div class="table-responsive">
    <table class="table table-bordered align-middle">
      <thead class="table-light">
        <tr>
          <th>User</th>
          <th>Type</th>
          <th>Target Role</th>
          <th>Scheduled</th>
          <th>Status</th>
          <th>Meeting Link</th>
          <th>Feedback</th>
          <th style="width:240px;">Update</th>
        </tr>
      </thead>
      <tbody>
        {% for i in interviews %}
        <tr>
          <td>{{ i.user.username }}</td>
          <td>{{ i.get_interview_type_display }}</td>
          <td>{{ i.target_role }}</td>
          <td>{% if i.scheduled_at %}{{ i.scheduled_at|date:"M d, Y H:i" }}{% else %}-{% endif %}</td>
          <td>
            <span class="badge
              {% if i.status == 'pending' %}bg-secondary
              {% elif i.status == 'scheduled' %}bg-primary
              {% elif i.status == 'completed' %}bg-success
              {% else %}bg-danger{% endif %}">
              {{ i.status|capfirst }}
            </span>
          </td>

          <td>
            {% if i.meeting_link %}
              <a href="{{ i.meeting_link }}" target="_blank">Open</a>
            {% else %}
              <span class="text-muted">None</span>
            {% endif %}
          </td>

          <td style="max-width:260px;white-space:pre-wrap;">{{ i.feedback|default:"-" }}</td>

          <td>
            <form method="POST" class="d-grid gap-2">
              {% csrf_token %}
              <input type="hidden" name="id" value="{{ i.id }}">

              <input name="meeting_link" class="form-control form-control-sm"
                     placeholder="https://meet.google.com/..."
                     value="{{ i.meeting_link|default:'' }}">

              <select name="status" class="form-select form-select-sm">
                <option value="pending" {% if i.status == "pending" %}selected{% endif %}>Pending</option>
                <option value="scheduled" {% if i.status == "scheduled" %}selected{% endif %}>Scheduled</option>
                <option value="completed" {% if i.status == "completed" %}selected{% endif %}>Completed</option>
                <option value="cancelled" {% if i.status == "cancelled" %}selected{% endif %}>Cancelled</option>
              </select>

              <textarea name="feedback" rows="2" class="form-control form-control-sm"
                        placeholder="Feedback (after interview)">{{ i.feedback|default:'' }}</textarea>

              <button class="btn btn-sm btn-primary">Save</button>
            </form>
          </td>
        </tr>
        {% empty %}
        <tr>
          <td colspan="8" class="text-center text-muted py-4">No mock interview requests yet.</td>
        </tr>
        {% endfor %}
      </tbody>
    </table>
  </div>

</div>
{% endblock %}
