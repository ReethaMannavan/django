{% extends 'base.html' %}

{% block title %}AI Interview Chatbot | VCS Careers{% endblock %}

{% block content %}
<h2>AI Interview Chatbot</h2>
<p>Ask questions about interview preparation, sample answers, and guidance.</p>

<div id="chatBox" style="border:1px solid #e5e7eb; padding:10px; height:300px; overflow-y:auto; margin-bottom:10px;">
  <!-- Chat messages appear here -->
</div>

<input type="text" id="userMessage" placeholder="Type your question..." style="width:70%; padding:8px;">
<button onclick="sendMessage()" style="padding:8px 12px; background:#2563eb; color:white; border:none; border-radius:4px;">Send</button>

<script>
function sendMessage() {
    const msgInput = document.getElementById('userMessage');
    const message = msgInput.value.trim();
    if(!message) return;

    // Show user's message
    const chatBox = document.getElementById('chatBox');
    chatBox.innerHTML += `<div style="color:#1e3a8a;"><b>You:</b> ${message}</div>`;

    fetch("{% url 'pro-interview-chatbot-api' %}", {
        method: "POST",
        headers: {
            "Content-Type": "application/x-www-form-urlencoded",
            "X-CSRFToken": "{{ csrf_token }}",
        },
        body: `message=${encodeURIComponent(message)}`
    })
    .then(res => res.json())
    .then(data => {
        const answer = data.answer || "Sorry, I couldn't generate a response.";
        chatBox.innerHTML += `<div style="color:#047857;"><b>AI:</b> ${answer}</div>`;
        chatBox.scrollTop = chatBox.scrollHeight;
    });

    msgInput.value = '';
}
</script>
{% endblock %}
